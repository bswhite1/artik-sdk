CMAKE_MINIMUM_REQUIRED	( VERSION 2.8 )
PROJECT			( artik-sdk-utils C CXX )

SET ( LIB_UTILS artik-sdk-utils CACHE INTERNAL "" FORCE )
SET ( ARTIK_UTILS_INCLUDE_DIR ${LIB_INC}/utils CACHE INTERNAL "" FORCE )
SET ( ARTIK_UTILS_LIBRARIES ${LIB_UTILS} CACHE INTERNAL "" FORCE )

SET ( SRC_UTILS
					artik_utils.c
					linux_utils.c
					cpp/artik_uri.cpp
)

ADD_LIBRARY (${LIB_UTILS} SHARED ${SRC_UTILS})
TARGET_COMPILE_DEFINITIONS ( ${LIB_UTILS}_c PRIVATE "-DEXPORT_API=__attribute__((visibility(\"default\")))")
TARGET_COMPILE_OPTIONS ( ${LIB_UTILS}_c PRIVATE "-fvisibility=hidden" "-fPIC" )
TARGET_INCLUDE_DIRECTORIES ( ${LIB_UTILS} PUBLIC
							 ${ARTIK_BASE_INCLUDE_DIR}
							 ${ARTIK_BASE_INCLUDE_DIR}/cpp
							 ${ARTIK_UTILS_INCLUDE_DIR}
							 ${ARTIK_UTILS_INCLUDE_DIR}/cpp
)

SET_TARGET_PROPERTIES ( ${LIB_UTILS} PROPERTIES VERSION ${LIB_VERSION_MAJOR}.${LIB_VERSION_MINOR}.${LIB_VERSION_PATCH} SOVERSION ${LIB_VERSION_MAJOR} OUTPUT_NAME ${LIB_UTILS} )
INSTALL ( TARGETS ${LIB_UTILS} LIBRARY DESTINATION "${CMAKE_INSTALL_LIBDIR}"
  PERMISSIONS OWNER_WRITE OWNER_READ OWNER_EXECUTE GROUP_READ GROUP_EXECUTE WORLD_READ WORLD_EXECUTE )

FILE ( GLOB UTILS_HEADERS "${LIB_INC}/utils/*.h" )
FILE ( GLOB UTILS_HEADERS_CPP "${LIB_INC}/utils/cpp/*.hh" )
INSTALL ( FILES ${UTILS_HEADERS} DESTINATION "${CMAKE_INSTALL_INCLUDEDIR}/artik/utils" )
INSTALL ( FILES ${UTILS_HEADERS_CPP} DESTINATION "${CMAKE_INSTALL_INCLUDEDIR}/artik/utils/cpp" )
